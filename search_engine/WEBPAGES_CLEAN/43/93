 //compile: g++ -o gg_wald gg_wald.cpp
//gg_wald cases.txt controls.txt pvalues.txt
//genotype coding: 0, 1, 2
//any value greater than 2, such as 3 or 9, is treated as missing

#include 
#include 
#include 
#include 
#include 
#include 
#include 
#include 
#include "wald.h"
#include "pchisq.c"
#include "bitcount.h"

using namespace std;

int main(int argc, char *argv[]){
	if(argc&gt; tmpInt)	nsub_case++;
	while(fin_case.getline(line, 10000)) nsnp++; 
	fin_case.close();


	nsub_control=0;
	nsnp2=1; 
	fin_control.getline(line, 10000);
	tmpStream.clear();
	tmpStream.str(line);
	while(tmpStream &gt;&gt; tmpInt)	nsub_control++;
	while(fin_control.getline(line, 10000)) nsnp2++; 
	fin_control.close();


	if(nsnp!=nsnp2) {
		cout  geno_case, geno_control;
	geno_case.assign(3*nsnp*nblocks_case, 0);
	geno_control.assign(3*nsnp*nblocks_control, 0);

	for(snp_i=0; snp_i&gt; tmpInt; 
			if(tmpInt&gt; tmpInt; 
			if(tmpInt0.9, do not calculate p-values
			a=n0[0*3+0]; b=n0[0*3+1]+n0[0*3+2]; c=n0[1*3+0]+n0[2*3+0];
			d=n0[1*3+1]+n0[1*3+2]+n0[2*3+1]+n0[2*3+2];
			if((a*d-b*c)*(a*d-b*c)/((a+c)*(b+d)*(a+b)*(c+d)) &gt; 0.9) {
				ofile 